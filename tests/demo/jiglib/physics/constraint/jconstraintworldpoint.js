(function(c){var e=c.Vector3DUtil;var b=c.JMatrix3D;var d=c.JNumber3D;var g=c.JConstraint;var f=c.RigidBody;var a=function(h,i,j){this.Super();this._body=h;this._pointOnBody=i;this._worldPosition=j;h.addConstraint(this);};c.extend(a,c.JConstraint);a.prototype.minVelForProcessing=0.001;a.prototype.allowedDeviation=0.01;a.prototype.timescale=4;a.prototype._body=null;a.prototype._pointOnBody=null;a.prototype._worldPosition=null;a.prototype.set_worldPosition=function(h){this._worldPosition=h;};a.prototype.get_worldPosition=function(){return this._worldPosition;};a.prototype.apply=function(h){this.set_satisfied(true);var m=this._pointOnBody.slice(0);b.multiplyVector(this._body.get_currentState().get_orientation(),m);m=e.add(m,this._body.get_currentState().position);var o=e.subtract(m,this._body.get_currentState().position);var s=e.add(this._body.get_currentState().linVelocity,e.crossProduct(this._body.get_currentState().rotVelocity,o));var i;var r;var l=e.subtract(m,this._worldPosition);var t=e.get_length(l);if(t>this.allowedDeviation){r=d.getDivideVector(l,t);i=d.getScaleVector(r,(this.allowedDeviation-t)/(this.timescale*h));}else{i=[0,0,0,0];}var q=e.subtract(s,i);var n=e.get_length(q);if(n<this.minVelForProcessing){return false;}q=d.getDivideVector(q,n);var p=e.crossProduct(o,q);b.multiplyVector(this._body.get_worldInvInertia(),p);var k=this._body.get_invMass()+e.dotProduct(q,e.crossProduct(p,o));if(k<d.NUM_TINY){return false;}var j=-n/k;this._body.applyWorldImpulse(d.getScaleVector(q,j),m);this._body.setConstraintsAndCollisionsUnsatisfied();this.set_satisfied(true);return true;};c.JConstraintWorldPoint=a;})(jigLib);